function resetUrl(){return UrlUtils.mergeParams(base_search_url,{...url_params,p:pageNum})}$(document).ready(function(){const lazyLoadInstance=new LazyLoad({});const params=UrlUtils.getCurrentParams();const q=params.get("q");const p=params.get("p");if(q){if(!p||p==1){saveSearchToLocalStorage(q);saveOneSearchHistory(q,saveSearchHistoryUrl)}}$(document).on("click","#filter-reset-js",function(){window.location.href=search_url});$(document).on("click","#apply-filter-js",function(){var params={};params["q"]=url_params["q"];var begin=$("#filter-price-min-js").val().trim();var end=$("#filter-price-max-js").val().trim();var priceValid=val=>{let n=parseFloat(val);return!isNaN(n)&&n>=0};if(begin&&priceValid(begin)||end&&priceValid(end)){let min=begin&&priceValid(begin)?parseFloat(begin):0;let max=end&&priceValid(end)?parseFloat(end):0;params["price"]=min+"-"+max}$(".filter-attr-js").each(function(){var attrCode=$(this).data("attr-code");var selectedIds=[];$(this).find(".filter-value-item-js.active").each(function(){selectedIds.push($(this).data("value-id"))});if(selectedIds.length>0){params[attrCode]=selectedIds.join(",")}});const finalUrl=UrlUtils.mergeParams(base_search_url,params);window.location.href=finalUrl});$(document).on("click",".filter-value-item-js",function(){var $item=$(this);var parent=$item.parent();if($item.hasClass("active")){$item.removeClass("active bg-primary text-white")}else{parent.find(".filter-value-item-js").removeClass("active bg-primary text-white");$item.addClass("active bg-primary text-white")}});$("#product-list-more").infiniteScroll({path:function(){if(this.loadCount<maxPage-1){return UrlUtils.mergeParams(base_search_url,{...url_params,p:this.loadCount+2})}},append:false,history:false,responseBody:"json",fetchOptions:{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",Accept:"application/json"}},checkLastPage:true,scrollThreshold:100,status:".page-load-status",prefill:false,debug:false});$("#product-list-more").on("load.infiniteScroll",function(event,body,path){if(body&&body.html&&body.html.trim()!==""){$(this).append(body.html);if(typeof lazyLoadInstance!=="undefined"){lazyLoadInstance.update()}}});$("#product-list-more").on("error.infiniteScroll",function(event,error,path){alert("Failed to load more products.")});$("#product-list-more").on("append.infiniteScroll",function(event,body,path,items){});$("#product-list-more").on("last.infiniteScroll",function(){})});